<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>数字アニメーション（壁あり）</title>
<style>
  body {
    margin: 0;
    overflow: hidden;
    background: #f5f5f5;
    cursor: default;
    position: relative;
    height: 100vh;
  }

  .number {
    position: absolute;
    font-size: 144px;
    font-weight: bold;
    white-space: nowrap;
  }

  .level-display {
    position: absolute;
    top: 10px;
    font-size: 20px;
    font-weight: bold;
    background: rgba(255,255,255,0.7);
    padding: 5px 10px;
    border-radius: 8px;
    z-index: 10;
    cursor: pointer;
  }

  .speed-level { left: 10px; }
  .wall-level { right: 10px; }

  /* 壁 */
  .wall {
    position: absolute;
    top: 0;
    height: 100%;
    background: black;
    z-index: 5;
    pointer-events: none;
  }
  .left-wall { left: 0; }
  .right-wall { right: 0; }
</style>
</head>
<body>

<div class="level-display speed-level" id="speedLevel">速度レベル 1</div>
<div class="level-display wall-level" id="wallLevel">壁レベル 1</div>

<div class="wall left-wall" id="leftWall"></div>
<div class="wall right-wall" id="rightWall"></div>

<script>
  const speedLevelEl = document.getElementById("speedLevel");
  const wallLevelEl = document.getElementById("wallLevel");
  const leftWall = document.getElementById("leftWall");
  const rightWall = document.getElementById("rightWall");

  const SPEEDS = [1000, 1400, 1800, 2200, 2600]; // px/s
  const WALL_LEVELS = [1200, 1000, 800, 600, 400]; // 表示窓幅

  let currentSpeedLevel = 0;
  let currentWallLevel = 0;

  function getRandomNumber() {
    return Math.floor(Math.random() * 100);
  }

  function updateWalls() {
    const windowWidth = WALL_LEVELS[currentWallLevel];
    let sideWidth = (window.innerWidth - windowWidth) / 2;

    if (sideWidth < 0) {
      // 画面が小さい場合は壁をなくす
      sideWidth = 0;
    }

    leftWall.style.width = sideWidth + "px";
    rightWall.style.width = sideWidth + "px";
  }

  function animateNumber() {
    const numberEl = document.createElement("div");
    numberEl.className = "number";
    numberEl.textContent = getRandomNumber();
    document.body.appendChild(numberEl);

    const numberWidth = numberEl.offsetWidth;
    const numberHeight = numberEl.offsetHeight;
    const startY = Math.random() * (window.innerHeight - numberHeight);

    const speed = SPEEDS[currentSpeedLevel]; // px/s
    const duration = window.innerWidth / speed * 1000; // ms

    numberEl.style.left = -numberWidth + "px";
    numberEl.style.top = startY + "px";

    numberEl.animate(
      [
        { transform: `translateX(0)` },
        { transform: `translateX(${window.innerWidth + numberWidth}px)` }
      ],
      {
        duration: duration,
        easing: "linear"
      }
    ).onfinish = () => numberEl.remove();

    setTimeout(animateNumber, 3000); // 3秒ごとに新しい数字
  }

  // 速度レベル切替
  speedLevelEl.addEventListener("click", (event) => {
    event.stopPropagation();
    currentSpeedLevel = (currentSpeedLevel + 1) % SPEEDS.length;
    speedLevelEl.textContent = `速度レベル ${currentSpeedLevel + 1}`;
  });

  // 壁レベル切替
  wallLevelEl.addEventListener("click", (event) => {
    event.stopPropagation();
    currentWallLevel = (currentWallLevel + 1) % WALL_LEVELS.length;
    wallLevelEl.textContent = `壁レベル ${currentWallLevel + 1}`;
    updateWalls();
  });

  // リサイズ時に壁を更新
  window.addEventListener("resize", updateWalls);

  // 初期化
  updateWalls();
  animateNumber();
</script>

</body>
</html>
